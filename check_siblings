library(openxlsx)

# Paths to your relevant Excel files
file1 <- "S:/Meg_Stuff/imagen_data/subject_ids_common.xlsx"
file2 <- "S:/Meg_Stuff/imagen_demographics/IMAGEN_siblings.xlsx"

#Read in the Subject_IDs from the excel files above
ids1 <- read.xlsx(file1)$Common_Subject_IDs
ids2 <- read.xlsx(file2)$Subject_IDs

# Find common IDs across all files
common_ids <- Reduce(intersect, list(ids1, ids2))

# Create a data frame of the overlapping IDs
common_df <- data.frame(Common_Subject_IDs = common_ids)

# Save to a new Excel file
output_file <- "S:/Meg_Stuff/imagen_demographics/imagen_siblings_overlap.xlsx"
write.xlsx(common_df, output_file, rowNames = FALSE)

#Done
cat("Common IDs saved to:", output_file, "\n")
